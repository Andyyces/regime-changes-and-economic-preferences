---
title: "Regime Changes and Economic Preferences: Global Evidence"
subtitle: "Empirical Research Task"
author:
  - Andrea Češková
  - Elvin Mammadov
format: pdf
bibliography: references.bib
bibliographystyle: apa
---

```{r}
#| message: false
#| warning: false
#| include: false
library(pacman)

p_load(haven,
       here,
       stargazer,
       summarytools,
       readxl,
       dplyr,
       lubridate,
       ggplot2,
       vdemdata,
       summarytools,
       devtools,
       zoo,
       tidyverse,
       fixest,
       dplyr,
       tidyr,
       modelsummary,
       tinytable,
       here,
       countrycode,
       gt,
       knitr,
       kableExtra
       )

```

# Data

Economic preferences: patience, risk taking, positive reciprocity, negative reciprocity, altruism, trust

|                                   |                                                           |                           |                                |
|:-------------------:|:-------------------:|---------------|---------------|
|               V-Dem               |                 General Preference Survey                 | Polity V                  | V-Dem Regime of World          |
|        Panel from 1789-now        |              Cross-section collected in 2012              | panel 1800--2023          | Panel from 1789-now            |
| Liberal Democracy Index ( 0 - 1 ) | 6 economic preferences, country, age, math skills, gender | Polity2 index \[-10: 10\] | categorical regime index (0-3) |

-   Combination of both: approx 75.000 individuals from 1910-2012 from 76 countries

-   Economic preferences are formed during childhood + adolescence (Detlefsen et al., 2024)

## Economic preferences

The **General Preference Survey (GPS)** measures the following **economic preferences**:

1.  **Patience** -- The extent to which individuals value future benefits over immediate rewards.

2.  **Risk-taking** -- Willingness to engage in decisions involving uncertainty or risk.

3.  **Positive reciprocity** -- The tendency to return a favor when treated kindly.

4.  **Negative reciprocity** -- The inclination to punish or retaliate when treated unfairly.

5.  **Altruism** -- Willingness to sacrifice personal gain for the benefit of others.

6.  **Trust** -- General belief in the reliability or integrity of other people.

# Setting

## Treatment group

-   Initial approach: Regime change experienced between 3 -18 years old (democratization / autocratization)
    -   Goal: identify whether an individual experienced a regime change during formative years (3-18)
        -   According to Lührmann et al. (2020): Evaluating differences of the LDI index at time **t** and **t-10** -\> **confidence intervals** -\>**no overlap** between them **AND** absolute value of the change in LDI is \> 0.05 **=** identified as regime change
        -   Was individual's age between 3-18 during this identified year -\> treated
-   **New approach**: democratization / autocratization as a treatment

```{r echo = FALSE}
 LDI_regime_change_visualization <- readRDS(here("Output" ,"figures",  "LDI_regime_change_visualization.rds"))
 
 plot(LDI_regime_change_visualization)



```

## Control group

The approach above assigns following individuals to be part of the control group:

-   **True controls:** Individuals from countries that never experienced any regime changes

-   **Contaminated controls:** Individuals from countries that did experience regime changes, but these individuals happen to be outside of their formative years when it occured -\> problematic, because they might have indirect exposure effect, they still lived through regime changes as adults outside of formative years. The following part of the code removes these individuals from out dataset.

```{r echo=FALSE}

```

# Econometric models

## Baseline specification

$$
Y_{ict} = \alpha + \beta \cdot \text{Autocratization}_{ic} + \gamma_c + \delta_t  + \varepsilon_{ict}
$$

$$
Y_{ict} = \alpha + \beta \cdot \text{Democratization}_{ic} + \gamma_c + \delta_t  + \varepsilon_{ict}
$$ Where:

$Y_{ict}$: **Preference outcome** (trust, patience, etc.) for **individual** ( i ), **country** ( c ), **birth cohort** ( t )

$\text{Autocratization}_{ic}$ or $\text{Democratization}_{ic}$ : Binary treatments indicator (1 if experienced democratization or autocratization during formative years, 0 otherwise)

$\gamma_c$ : Country fixed effects

$\delta_t$ : Birth cohort fixed effects

$X_{ict}$ : Controls including:

Average V-Dem LDI during formative years (ages 3-18)

Average GDP in formative years

Recession experience

$\beta$ : Causal effect of interest

-   Goal: Exploit cross-sectional variation between individuals who experienced regime changes and those who didn't, within the same country and birth cohort, while controlling for observed characteristics

# Results

# Robustness check

```{r}
#| message: false
#| warning: false
#| include: false

# Define preference names for titles
hetero_models_v2 <- readRDS(here("Output", "Models", "v2xregime results", "hetero_models_v2xregime.rds"))
hetero_models_democ_v2 <- readRDS(here("Output", "Models", "v2xregime results", "hetero_models_democ_v2xregime.rds"))
hetero_models_autoc_v2 <- readRDS(here("Output", "Models", "v2xregime results", "hetero_models_autoc_v2xregime.rds"))


# LDE model
lde_combined <- readRDS(here("Output", "Models", "hetero_models.rds"))
lde_democ    <- readRDS(here("Output", "Models","hetero_models_democ.rds"))
lde_autoc    <- readRDS(here("Output", "Models","hetero_models_autoc.rds"))
preference_names <- c("Patience", "Risk taking", "Positive reciprocity", 
                      "Negative reciprocity", "Altruism", "Trust")

```









```{r}
#| message: false
#| warning: false
#| include: false


# Preference üzrə cədvəl yaradan funksiya
create_full_comparison_table <- function(i, preference_names,
                                         regime_combined, regime_democ, regime_autoc,
                                         lde_combined, lde_democ, lde_autoc) {
  
  msummary(
    list(
      "Regime: Combined" = regime_combined[[i]],
      "Regime: Democratization" = regime_democ[[i]],
      "Regime: Autocratization" = regime_autoc[[i]],
      "LDE: Combined" = lde_combined[[i]],
      "LDE: Democratization" = lde_democ[[i]],
      "LDE: Autocratization" = lde_autoc[[i]]
    ),
    stars = TRUE,
    coef_rename = c(
      "democratization" = "Democratization",
      "autocratization" = "Autocratization"
    ),
    gof_omit = "AIC|BIC|RMSE",
    statistic = "({std.error})",
    output = "kableExtra",
    fmt = 3,
    title = preference_names[i],
    notes = list(
      "+ p < 0.1, * p < 0.05, ** p < 0.01, *** p < 0.001",
      "Standard errors clustered at isocode (country) level. Fixed effects for region and birth year included."
    )
  ) %>%
    kable_styling(
      latex_options = c("scale_down", "striped"),
      position = "center",
      full_width = FALSE
    ) %>%
    add_header_above(c(" " = 1, "Model Comparison" = 6), bold = TRUE)
}

```


```{r}
#| label: tbl-preference-patience
#| echo: false
#| results: asis
#| message: false
#| warning: false

create_full_comparison_table(
  i = 1,
  preference_names = preference_names,
  regime_combined = hetero_models_v2,
  regime_democ = hetero_models_democ_v2,
  regime_autoc = hetero_models_autoc_v2,
  lde_combined = lde_combined,
  lde_democ = lde_democ,
  lde_autoc = lde_autoc
)
```


```{r}
#| label: tbl-preference-risk
#| echo: false
#| results: asis
#| message: false
#| warning: false


create_full_comparison_table(
  i = 2,
  preference_names = preference_names,
  regime_combined = hetero_models_v2,
  regime_democ = hetero_models_democ_v2,
  regime_autoc = hetero_models_autoc_v2,
  lde_combined = lde_combined,
  lde_democ = lde_democ,
  lde_autoc = lde_autoc
)

```

