---
title: "Regime Changes and Economic Preferences: Global Evidence"
subtitle: "Milestone 5: Robustness"
author: "Andrea Češková, Elvin Mammadov"
format: 
  pdf:
    reference-location: document
number-sections: true
toc: true
crossref:
  fig-title: "Figure"
  tbl-title: "Table"
  eq-title: "Equation"
  lot-title: "List of figures"
bibliography: references.bib
link-citations: true
---

```{r}
#| message: false
#| warning: false
#| include: false
library(pacman)

p_load(haven,
       here,
       stargazer,
       summarytools,
       readxl,
       dplyr,
       lubridate,
       ggplot2,
       vdemdata,
       summarytools,
       devtools,
       zoo,
       tidyverse,
       fixest,
       dplyr,
       tidyr,
       modelsummary,
       tinytable,
       here,
       countrycode,
       gt,
       knitr,
       kableExtra
       )
```

```{r}
#| include: false
sample_composition <- readRDS(here("Output", "Tables", "sample_composition.rds"))
clustering_results <- readRDS(here("Output", "Robustness", "clustering_results.rds"))
country_summary <- readRDS(here("Input", "clean", "country_summary.rds"))

# Regime changes visualization
# Polity5
all_countries_plot_polity <- readRDS(here("Output", "figures", "all_countries_plot_polity.rds"))
# RWI
all_countries_plot_RWI <- readRDS(here("Output", "figures", "all_countries_plot_RWI.rds"))
```

```{r}
#| message: false
#| warning: false
#| include: false
demo_summary <- clustering_results$demo_summary
auto_summary <- clustering_results$auto_summary
```

# Sample composition

Our final analytical sample consists of `r sum(sample_composition$n)` individuals across three groups:

```{r}
#| echo: false
#| label: tbl-samplecomp
#| tbl-cap: "Sample Composition by Treatment Type"
#| tbl-pos: "h"
create_summary_table <- function() {
  
  # Defining group labels 
  group_labels <- c(
    "0" = "Control (No regime change)",  
    "1" = "Autocratization",              
    "2" = "Democratization"             
  )
  
  # Calculating summary statistics
  summary_table <- country_summary %>%
    group_by(first_formative_type) %>%
    summarise(
      N = sum(n_individuals, na.rm = TRUE),
      .groups = 'drop'
    ) %>%
    mutate(
      Group = case_when(
        first_formative_type == 0 ~ "Control (No regime change)",
        first_formative_type == 1 ~ "Autocratization", 
        first_formative_type == 2 ~ "Democratization",
        TRUE ~ as.character(first_formative_type)
      ),
      Proportion = round(N / sum(N), 2),
      Percentage = round((N / sum(N)) * 100, 1)
    ) %>%
    select(Group, N, Proportion, Percentage) %>%
    arrange(desc(N))  # Sorting by sample size, largest first
  
  return(summary_table)
}

# Generating the table
table_data <- create_summary_table()

# Creating a formatted table
formatted_table <- table_data %>%
  kable(
    col.names = c("Group", "N", "Proportion", "Percentage"),
    align = c("l", "r", "r", "r"),
    format = "latex"
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover"),
    full_width = FALSE,
    position = "center"
  ) %>%
  add_footnote(
    "Distribution of observations across control and treatment groups.",
    notation = "none"
  )

# Displaying the formatted table
formatted_table
```

# Different specification

## Clustering of standard errors

Our baseline specification clusters standard errors at the country level, reflecting our assumption that the primary source of correlation in errors stems from shared country-specific factors such as cultural norms, institutional quality, and historical experiences. To assess the robustness of our inference, we examine how our results change under alternative clustering assumptions.

In this chapter we present sensitivity analysis across four clustering methods: **country-level clustering (our baseline)**, **two-way clustering by country and birth cohort**, **regional clustering**, and **birth cohort clustering**. We chose to analyse only our baseline specification. @tbl-cluster_democ shows the results for base specification: democratization and @tbl-cluster_autoc for base specification: autocratization.

```{r}
#| message: false
#| warning: false
#| include: false

# Function to create professional clustering tables for PDF
create_clustering_table_pdf <- function(summary_data, treatment_type) {
  
  summary_data$preference <- c("Patience", "Risk taking", "Positive Reciprocity", "Negative Reciprocity", "Altruism", "Trust")
  # Clean up column names to match your report style
  colnames(summary_data) <- c("", "Country", "Two-way", "Region", "Cohort")
  
  # Create the table for PDF/LaTeX output
  table <- summary_data %>%
    kable(format = "latex", 
          align = c("l", "c", "c", "c", "c"),
          escape = FALSE) %>%
    kable_styling(
      latex_options = c("striped", "scale_down"),
      full_width = FALSE,
      position = "center",
      font_size = 10
    ) %>%
    row_spec(0, bold = TRUE) %>%
    column_spec(1, width = "4cm", bold = FALSE) %>%
    column_spec(2:5, width = "2cm") %>%
    add_header_above(c(" " = 1, "Clustering Method" = 4), bold = TRUE) %>%
    footnote(
      general = "Standard errors clustered as indicated in column headers. All models include region and birth year fixed effects.",
      general_title = "Note:",
      footnote_as_chunk = TRUE,
      threeparttable = TRUE
    )
  
  return(table)
}

```

The patience affect in @tbl-cluster_democ remains stable across all clustering methods, with standard errors ranging from 0.0207 to 0.0262, maintaining significance at the 5% level or better. This consistency provides **strong evidence** that our main finding---**experiencing democratization during formative years increases patience**---is not just because of our choice of one clustering method.

The similarity between standard errors under country-level (0.025) and two-way clustering (0.024) indicates minimal temporal correlation within countries. Regional clustering yields slightly larger standard errors, as expected given the smaller number of clusters, while cohort clustering produces the smallest standard errors.

Notably, the **altruism coefficient** exhibits sensitivity to the clustering method. While the point estimate remains stable at -0.078, it is insignificant under country clustering but becomes **highly significant (p \< 0.001)** under **cohort clustering**. This pattern suggests that altruism preferences exhibit **stronger within-country correlation than within-cohort correlation** - in other words, individuals within the same country are more similar to each other in their altruism preferences than individuals born in the same year globally. This likely reflects the importance of country-specific cultural transmission mechanisms in shaping other-regarding preferences.

```{r}
#| echo: false
#| label: tbl-cluster_democ
#| tbl-cap: "Sensitivity to Clustering Approaches - Democratization Effects"
#| tbl-pos: "h"
#| fig-pos: "h"
demo_table_pdf <- create_clustering_table_pdf(demo_summary, 
                                              "democratization")

demo_table_pdf
```

Results in @tbl-cluster_autoc how generally weaker effects across all clustering methods, consistent with our main findings. The marginal significance of positive reciprocity is relatively stable across specifications, while other effects remain statistically insignificant regardless of clustering approach.

```{r}
#| echo: false
#| label: tbl-cluster_autoc
#| tbl-cap: "Sensitivity to Clustering Approaches - Autocratization Effects"
#| tbl-pos: "h"
#| fig-pos: "h"
auto_table_pdf <- create_clustering_table_pdf(auto_summary, 
                                              "autocratization")
auto_table_pdf
```

Overall, these robustness checks strengthen confidence in our core findings while highlighting which results are sensitive to different clustering approaches. The **persistence of the democratization-patience relationship** across all specifications underscores its robustness as our primary empirical contribution.

# Different Datasets

We aimed to test the same methodological approach on different kinds of datasets, to asses the robustness of our results.

## V-dem: Regime of the World Index

The Varieties of Democracy (V-Dem) Regimes of the World Index (v2xregime) represents a different approach to measuring political regimes.

The classification system distinguishes between four distinct regime types:

-   **Closed Autocracies** (0), where citizens have no meaningful opportunity to participate in elections and political power is highly concentrated;

-   **Electoral Autocracies** (1), which hold de jure multiparty elections that are neither free nor fair, with core democratic rights remaining restricted;

-   **Electoral Democracies** (2), characterized by relatively free and fair elections but with potentially weak or partially undermined democratic institutions such as judicial independence or media freedom;

-   **Liberal Democracies** (3), which not only conduct free and fair elections but also maintain strong civil liberties, rule of law, and robust checks and balances on executive power [@coppedge_v-dem_2025].

```{r}
#| echo: false
#| warning: false
#| message: false
#| fig-width: 16
#| fig-height: 12
#| fig-cap: "VDem RWI: Regime Changes by Country and Continent (Post-1920)"
#| label: fig-regime-changes-RWI

all_countries_plot_RWI
```





```{r}
#| message: false
#| warning: false
#| include: false

# Define preference names for titles
hetero_models_v2 <- readRDS(here("Output", "Models", "v2xregime results", "hetero_models_v2xregime.rds"))
hetero_models_democ_v2 <- readRDS(here("Output", "Models", "v2xregime results", "hetero_models_democ_v2xregime.rds"))
hetero_models_autoc_v2 <- readRDS(here("Output", "Models", "v2xregime results", "hetero_models_autoc_v2xregime.rds"))


# LDE model
lde_combined <- readRDS(here("Output", "Models", "hetero_models.rds"))
lde_democ    <- readRDS(here("Output", "Models","hetero_models_democ.rds"))
lde_autoc    <- readRDS(here("Output", "Models","hetero_models_autoc.rds"))
preference_names <- c("Patience", "Risk taking", "Positive reciprocity", 
                      "Negative reciprocity", "Altruism", "Trust")

```





```{r}
#| message: false
#| warning: false
#| include: false



create_full_comparison_table <- function(i, preference_names,
                                         regime_combined, regime_democ, regime_autoc,
                                         lde_combined, lde_democ, lde_autoc) {
  
  msummary(
    list(
      "Regime: Combined" = regime_combined[[i]],
      "Regime: Democratization" = regime_democ[[i]],
      "Regime: Autocratization" = regime_autoc[[i]],
      "LDE: Combined" = lde_combined[[i]],
      "LDE: Democratization" = lde_democ[[i]],
      "LDE: Autocratization" = lde_autoc[[i]]
    ),
    stars = TRUE,
    coef_rename = c(
      "democratization" = "Democratization",
      "autocratization" = "Autocratization"
    ),
    gof_omit = "AIC|BIC|RMSE",
    statistic = "({std.error})",
    output = "kableExtra",
    fmt = 3,
    title = preference_names[i],
    notes = list(
      "+ p < 0.1, * p < 0.05, ** p < 0.01, *** p < 0.001",
      "Standard errors clustered at isocode (country) level. Fixed effects for region and birth year included."
    )
  ) %>%
    kable_styling(
      latex_options = c("scale_down", "striped"),
      position = "center",
      full_width = FALSE
    ) %>%
    add_header_above(c(" " = 1, "Model Comparison" = 6), bold = TRUE)
}

```



```{r}
#| label: tbl-preference-patience
#| echo: false
#| results: asis
#| message: false
#| warning: false

create_full_comparison_table(
  i = 1,
  preference_names = preference_names,
  regime_combined = hetero_models_v2,
  regime_democ = hetero_models_democ_v2,
  regime_autoc = hetero_models_autoc_v2,
  lde_combined = lde_combined,
  lde_democ = lde_democ,
  lde_autoc = lde_autoc
)
```



```{r}
#| label: tbl-preference-risk
#| echo: false
#| results: asis
#| message: false
#| warning: false

create_full_comparison_table(
  i = 2,
  preference_names = preference_names,
  regime_combined = hetero_models_v2,
  regime_democ = hetero_models_democ_v2,
  regime_autoc = hetero_models_autoc_v2,
  lde_combined = lde_combined,
  lde_democ = lde_democ,
  lde_autoc = lde_autoc
)
```



```{r}
#| label: tbl-preference-pos-rec
#| echo: false
#| results: asis
#| message: false
#| warning: false

create_full_comparison_table(
  i = 3,
  preference_names = preference_names,
  regime_combined = hetero_models_v2,
  regime_democ = hetero_models_democ_v2,
  regime_autoc = hetero_models_autoc_v2,
  lde_combined = lde_combined,
  lde_democ = lde_democ,
  lde_autoc = lde_autoc
)
```

```{r}
#| label: tbl-preference-neg-rec
#| echo: false
#| results: asis
#| message: false
#| warning: false

create_full_comparison_table(
  i = 4,
  preference_names = preference_names,
  regime_combined = hetero_models_v2,
  regime_democ = hetero_models_democ_v2,
  regime_autoc = hetero_models_autoc_v2,
  lde_combined = lde_combined,
  lde_democ = lde_democ,
  lde_autoc = lde_autoc
)
```

```{r}
#| label: tbl-preference-Altruism
#| echo: false
#| results: asis
#| message: false
#| warning: false

create_full_comparison_table(
  i = 5,
  preference_names = preference_names,
  regime_combined = hetero_models_v2,
  regime_democ = hetero_models_democ_v2,
  regime_autoc = hetero_models_autoc_v2,
  lde_combined = lde_combined,
  lde_democ = lde_democ,
  lde_autoc = lde_autoc
)
```


```{r}
#| label: tbl-preference-trust
#| echo: false
#| results: asis
#| message: false
#| warning: false

create_full_comparison_table(
  i = 6,
  preference_names = preference_names,
  regime_combined = hetero_models_v2,
  regime_democ = hetero_models_democ_v2,
  regime_autoc = hetero_models_autoc_v2,
  lde_combined = lde_combined,
  lde_democ = lde_democ,
  lde_autoc = lde_autoc
)
```
### Specification with Controls

```{r}
#| message: false
#| warning: false
#| include: false

# Read models first
hetero_models_controls_v2 <- readRDS(here("Output", "Models", "v2xregime results", "hetero_models_controls_v2xregime.rds"))
hetero_models_democ_controls_v2 <- readRDS(here("Output", "Models", "v2xregime results", "hetero_models_democ_controls_v2xregime.rds"))
hetero_models_autoc_controls_v2 <- readRDS(here("Output", "Models", "v2xregime results", "hetero_models_autoc_controls_v2xregime.rds"))




# LDE-based model
lde_controls_combined <- readRDS(here("Output", "Models","hetero_models_controls.rds"))
lde_controls_democ    <- readRDS(here("Output", "Models","hetero_models_democ_controls.rds"))
lde_controls_autoc    <- readRDS(here("Output", "Models","hetero_models_autoc_controls.rds"))
```



```{r}
#| message: false
#| warning: false
#| include: false

create_full_comparison_table_controls <- function(i, preference_names,
                                                  regime_combined, regime_democ, regime_autoc,
                                                  lde_combined, lde_democ, lde_autoc) {
  
  msummary(
    list(
      "Regime: Combined" = regime_combined[[i]],
      "Regime: Democratization" = regime_democ[[i]],
      "Regime: Autocratization" = regime_autoc[[i]],
      "LDE: Combined" = lde_combined[[i]],
      "LDE: Democratization" = lde_democ[[i]],
      "LDE: Autocratization" = lde_autoc[[i]]
    ),
    stars = TRUE,
    coef_rename = c(
      "democratization" = "Democratization",
      "autocratization" = "Autocratization",
      "avg_gdppc_formative" = "Log of Average GDP per Capita during formative years",
      "recession_formative" = "Recession experienced during formative years" ,
      "avg_libdem_formative" = "Average LDI during formative years "
    ),
    gof_omit = "AIC|BIC|RMSE",
    statistic = "({std.error})",
    output = "kableExtra",
    fmt = 3,
    title = preference_names[i],
    notes = list(
      "+ p < 0.1, * p < 0.05, ** p < 0.01, *** p < 0.001",
      "Standard errors clustered at isocode (country) level. Fixed effects for region and birth year included. Controls added."
    )
  ) %>%
    kable_styling(
      latex_options = c("scale_down", "striped"),
      position = "center",
      full_width = FALSE
    ) %>%
    add_header_above(c(" " = 1, "Model Comparison (with controls)" = 6), bold = TRUE)
}

```


```{r}
#| label: tbl-patience-controls
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_full_comparison_table_controls(
  i = 1,
  preference_names = preference_names,
  regime_combined = hetero_models_controls_v2,
  regime_democ = hetero_models_democ_controls_v2,
  regime_autoc = hetero_models_autoc_controls_v2,
  lde_combined = lde_controls_combined,
  lde_democ = lde_controls_democ,
  lde_autoc = lde_controls_autoc
)

```

```{r}
#| label: tbl-risk-controls
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_full_comparison_table_controls(
  i = 2,
  preference_names = preference_names,
  regime_combined = hetero_models_controls_v2,
  regime_democ = hetero_models_democ_controls_v2,
  regime_autoc = hetero_models_autoc_controls_v2,
  lde_combined = lde_controls_combined,
  lde_democ = lde_controls_democ,
  lde_autoc = lde_controls_autoc
)

```
Autocratization has strongly negative effect on Risk Taking of individuals.

```{r}
#| label: tbl-pos-rec-controls
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_full_comparison_table_controls(
  i = 3,
  preference_names = preference_names,
  regime_combined = hetero_models_controls_v2,
  regime_democ = hetero_models_democ_controls_v2,
  regime_autoc = hetero_models_autoc_controls_v2,
  lde_combined = lde_controls_combined,
  lde_democ = lde_controls_democ,
  lde_autoc = lde_controls_autoc
)

```

```{r}
#| label: tbl-neg-rec-controls
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_full_comparison_table_controls(
  i = 4,
  preference_names = preference_names,
  regime_combined = hetero_models_controls_v2,
  regime_democ = hetero_models_democ_controls_v2,
  regime_autoc = hetero_models_autoc_controls_v2,
  lde_combined = lde_controls_combined,
  lde_democ = lde_controls_democ,
  lde_autoc = lde_controls_autoc
)

```


```{r}
#| label: tbl-altruism-controls
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_full_comparison_table_controls(
  i = 5,
  preference_names = preference_names,
  regime_combined = hetero_models_controls_v2,
  regime_democ = hetero_models_democ_controls_v2,
  regime_autoc = hetero_models_autoc_controls_v2,
  lde_combined = lde_controls_combined,
  lde_democ = lde_controls_democ,
  lde_autoc = lde_controls_autoc
)

```


```{r}
#| label: tbl-trust-controls
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_full_comparison_table_controls(
  i = 6,
  preference_names = preference_names,
  regime_combined = hetero_models_controls_v2,
  regime_democ = hetero_models_democ_controls_v2,
  regime_autoc = hetero_models_autoc_controls_v2,
  lde_combined = lde_controls_combined,
  lde_democ = lde_controls_democ,
  lde_autoc = lde_controls_autoc
)

```
Patience is positively and strongly associated with the log of average GDP per capita during formative years across all models. This suggests that individuals who grew up in wealthier economic environments tend to be more patient. Risk taking significantly decreases following autocratization in regime-based models. Negative reciprocity significantly declines after autocratization in regime models , indicating that such political transitions may suppress retaliatory economic behaviors. Trust decreases substantially in response to autocratization in regime-based models, highlighting a strong erosion of interpersonal or institutional trust in individuals exposed to such regime shifts.


## Polity5 dataset

The Polity5 dataset, developed by the Center for Systemic Peace, provides measures of political regime characteristics and transitions for independent states worldwide from 1800 to 2018. The dataset covers all major independent countries with populations exceeding 500,000 (167 countries as of 2018) [@noauthor_polityproject_nodate].

The dataset's core measurement framework centers on three key dimensions of political authority: (1) executive recruitment (how leaders come to power), (2) executive constraints (limitations on executive power), and (3) political competition (the extent of political participation and opposition). These components are combined to create c**omposite democracy (DEMOC)** and **autocracy (AUTOC)** scores, each ranging from 0 to 10, which can be further combined into the **POLITY score ranging from -10 (full autocracy) to +10 (full democracy)** [@noauthor_polityproject_nodate].

```{r}
#| echo: false
#| warning: false
#| message: false
#| fig-width: 16
#| fig-height: 12
#| fig-cap: "Polity5: Regime Changes by Country and Continent (Post-1920)"
#| label: fig-regime-changes-polity

all_countries_plot_polity
```






```{r}
#| message: false
#| warning: false
#| include: false

# Load models from the "polity results" folder
hetero_models_polity <- readRDS(here("Output", "Models", "polity results", "hetero_models_polity.rds"))
hetero_models_democ_polity <- readRDS(here("Output", "Models", "polity results", "hetero_models_democ_polity.rds"))
hetero_models_autoc_polity <- readRDS(here("Output", "Models", "polity results", "hetero_models_autoc_polity.rds"))

```




```{r}
#| message: false
#| warning: false
#| include: false

create_polity_lde_comparison_table <- function(i, preference_names,
                                               regime_combined, regime_democ, regime_autoc,
                                               lde_combined, lde_democ, lde_autoc) {
  
  msummary(
    list(
      "Regime: Combined" = regime_combined[[i]],
      "Regime: Democratization" = regime_democ[[i]],
      "Regime: Autocratization" = regime_autoc[[i]],
      "LDE: Combined" = lde_combined[[i]],
      "LDE: Democratization" = lde_democ[[i]],
      "LDE: Autocratization" = lde_autoc[[i]]
    ),
    stars = TRUE,
    coef_rename = c(
      "democratization" = "Democratization",
      "autocratization" = "Autocratization"
    ),
    gof_omit = "AIC|BIC|RMSE",
    statistic = "({std.error})",
    output = "kableExtra",
    fmt = 3,
    title = preference_names[i],
    notes = list(
      "+ p < 0.1, * p < 0.05, ** p < 0.01, *** p < 0.001",
      "Standard errors clustered at isocode (country) level. Fixed effects for region and birth year included."
    )
  ) %>%
    kable_styling(
      latex_options = c("scale_down", "striped"),
      position = "center",
      full_width = FALSE
    ) %>%
    add_header_above(c(" " = 1, "Polity vs. LDE Model Comparison" = 6), bold = TRUE)
}


```



```{r}
#| label: tbl-polity-patience
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_polity_lde_comparison_table(
  i = 1,
  preference_names = preference_names,
  regime_combined = hetero_models_polity,
  regime_democ = hetero_models_democ_polity,
  regime_autoc = hetero_models_autoc_polity,
  lde_combined = lde_combined,
  lde_democ = lde_democ,
  lde_autoc = lde_autoc
)

```



```{r}
#| label: tbl-polity-risk
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_polity_lde_comparison_table(
  i = 2,
  preference_names = preference_names,
  regime_combined = hetero_models_polity,
  regime_democ = hetero_models_democ_polity,
  regime_autoc = hetero_models_autoc_polity,
  lde_combined = lde_combined,
  lde_democ = lde_democ,
  lde_autoc = lde_autoc
)

```



```{r}
#| label: tbl-polity-pos-rec
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_polity_lde_comparison_table(
  i = 3,
  preference_names = preference_names,
  regime_combined = hetero_models_polity,
  regime_democ = hetero_models_democ_polity,
  regime_autoc = hetero_models_autoc_polity,
  lde_combined = lde_combined,
  lde_democ = lde_democ,
  lde_autoc = lde_autoc
)

```




```{r}
#| label: tbl-polity-neg-rec
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_polity_lde_comparison_table(
  i = 4,
  preference_names = preference_names,
  regime_combined = hetero_models_polity,
  regime_democ = hetero_models_democ_polity,
  regime_autoc = hetero_models_autoc_polity,
  lde_combined = lde_combined,
  lde_democ = lde_democ,
  lde_autoc = lde_autoc
)

```





```{r}
#| label: tbl-polity-altruism
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_polity_lde_comparison_table(
  i = 5,
  preference_names = preference_names,
  regime_combined = hetero_models_polity,
  regime_democ = hetero_models_democ_polity,
  regime_autoc = hetero_models_autoc_polity,
  lde_combined = lde_combined,
  lde_democ = lde_democ,
  lde_autoc = lde_autoc
)

```



```{r}
#| label: tbl-polity-trust
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_polity_lde_comparison_table(
  i = 6,
  preference_names = preference_names,
  regime_combined = hetero_models_polity,
  regime_democ = hetero_models_democ_polity,
  regime_autoc = hetero_models_autoc_polity,
  lde_combined = lde_combined,
  lde_democ = lde_democ,
  lde_autoc = lde_autoc
)

```

### Specification with Controls



```{r}
# Read polity-based models with controls
hetero_models_controls_polity <- readRDS(here("Output", "Models", "polity results", "hetero_models_controls_polity.rds"))
hetero_models_democ_controls_polity <- readRDS(here("Output", "Models", "polity results", "hetero_models_democ_controls_polity.rds"))
hetero_models_autoc_controls_polity <- readRDS(here("Output", "Models", "polity results", "hetero_models_autoc_controls_polity.rds"))

```


```{r}
#| message: false
#| warning: false
#| include: false

create_polity_lde_controls_table <- function(i, preference_names,
                                             regime_combined, regime_democ, regime_autoc,
                                             lde_combined, lde_democ, lde_autoc) {
  
  msummary(
    list(
      "Regime: Combined" = regime_combined[[i]],
      "Regime: Democratization" = regime_democ[[i]],
      "Regime: Autocratization" = regime_autoc[[i]],
      "LDE: Combined" = lde_combined[[i]],
      "LDE: Democratization" = lde_democ[[i]],
      "LDE: Autocratization" = lde_autoc[[i]]
    ),
    stars = TRUE,
    coef_rename = c(
      "democratization" = "Democratization",
      "autocratization" = "Autocratization",
      "avg_gdppc_formative" = "Log of Average GDP per Capita during formative years",
      "recession_formative" = "Recession experienced during formative years",
       "avg_libdem_formative" = "Average LDI during formative years ", 
      "avg_polity2_formative" = "Average polity index during formative years"	
    ),
    gof_omit = "AIC|BIC|RMSE",
    statistic = "({std.error})",
    output = "kableExtra",
    fmt = 3,
    title = preference_names[i],
    notes = list(
      "+ p < 0.1, * p < 0.05, ** p < 0.01, *** p < 0.001",
      "Standard errors clustered at isocode (country) level. Fixed effects and controls included."
    )
  ) %>%
    kable_styling(
      latex_options = c("scale_down", "striped"),
      position = "center",
      full_width = FALSE
    ) %>%
    add_header_above(c(" " = 1, "Polity + LDE Comparison (with Controls)" = 6), bold = TRUE)
}

```


```{r}
#| label: tbl-patience-polity-controls
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_polity_lde_controls_table(
  i = 1,
  preference_names = preference_names,
  regime_combined = hetero_models_controls_polity,
  regime_democ = hetero_models_democ_controls_polity,
  regime_autoc = hetero_models_autoc_controls_polity,
  lde_combined = lde_controls_combined,
  lde_democ = lde_controls_democ,
  lde_autoc = lde_controls_autoc
)

```

```{r}
#| label: tbl-risk-polity-controls
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_polity_lde_controls_table(
  i = 2,
  preference_names = preference_names,
  regime_combined = hetero_models_controls_polity,
  regime_democ = hetero_models_democ_controls_polity,
  regime_autoc = hetero_models_autoc_controls_polity,
  lde_combined = lde_controls_combined,
  lde_democ = lde_controls_democ,
  lde_autoc = lde_controls_autoc
)

```

```{r}
#| label: tbl-pos-rec-polity-controls
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_polity_lde_controls_table(
  i = 3,
  preference_names = preference_names,
  regime_combined = hetero_models_controls_polity,
  regime_democ = hetero_models_democ_controls_polity,
  regime_autoc = hetero_models_autoc_controls_polity,
  lde_combined = lde_controls_combined,
  lde_democ = lde_controls_democ,
  lde_autoc = lde_controls_autoc
)

```


```{r}
#| label: tbl-neg-rec-polity-controls
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_polity_lde_controls_table(
  i = 4,
  preference_names = preference_names,
  regime_combined = hetero_models_controls_polity,
  regime_democ = hetero_models_democ_controls_polity,
  regime_autoc = hetero_models_autoc_controls_polity,
  lde_combined = lde_controls_combined,
  lde_democ = lde_controls_democ,
  lde_autoc = lde_controls_autoc
)

```


```{r}
#| label: tbl-altruism-polity-controls
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_polity_lde_controls_table(
  i = 5,
  preference_names = preference_names,
  regime_combined = hetero_models_controls_polity,
  regime_democ = hetero_models_democ_controls_polity,
  regime_autoc = hetero_models_autoc_controls_polity,
  lde_combined = lde_controls_combined,
  lde_democ = lde_controls_democ,
  lde_autoc = lde_controls_autoc
)

```



```{r}
#| label: tbl-trust-polity-controls
#| echo: false
#| results: asis
#| warning: false
#| message: false

create_polity_lde_controls_table(
  i = 6,
  preference_names = preference_names,
  regime_combined = hetero_models_controls_polity,
  regime_democ = hetero_models_democ_controls_polity,
  regime_autoc = hetero_models_autoc_controls_polity,
  lde_combined = lde_controls_combined,
  lde_democ = lde_controls_democ,
  lde_autoc = lde_controls_autoc
)

```


But in all 3 different data based models, we can see that Log of Average GDP per Capita has strongly positive effect on Patience. This coefficient from Polity based model is way more than rest 2 different data based models
# References
